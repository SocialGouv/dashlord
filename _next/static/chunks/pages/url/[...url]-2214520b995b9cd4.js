(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[389],{50022:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/url/[...url]",function(){return t(28476)}])},28476:function(e,r,t){"use strict";t.r(r),t.d(r,{__N_SSG:function(){return er},default:function(){return rr}});var n=t(85893),i=t(9008),a=t(74041),l=t(67294),o=t(41027),s=t(34588),c=t(19589),u=t(73973),d=t(49384),f=t(84517),m=t(18121),p=t(20836);function b(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var h=function(e){var r=e.score_modifier,t=r<-50||r<-30?"danger":r<-20?"warning":r<-10?"info":"success";return(0,n.jsx)(f.Z,{className:"w-100",variant:t,children:r})},g={"content-security-policy":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://owasp.org/www-community/controls/Content_Security_Policy",children:"Doc Content Security Policy"}),". L'extension"," ",(0,n.jsx)("a",{href:"https://github.com/april/laboratory",rel:"noopener noreferrer",target:"_blank",children:"github.com/april/laboratory"})," ","permet de g\xe9n\xe9rer la CSP pour votre application."]}),"x-frame-options":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/fr/docs/Web/HTTP/Headers/X-Frame-Options",children:"Doc header X-Frame-Options"}),"."]}),"strict-transport-security":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security",children:"Doc header Strict-Transport-Security (HSTS)"}),"."]}),"x-content-type-options":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/fr/docs/Web/HTTP/Headers/X-Content-Type-Options",children:"Doc header X-Content-Type-Options"}),"."]}),"x-xss-protection":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection",children:"Doc header X-XSS-Protection"}),"."]}),cookies:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies",children:"OWASP Session Management Cheat Sheet"}),"."]}),"subresource-integrity":(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("a",{rel:"noopener noreferrer",target:"_blank",href:"https://developer.mozilla.org/fr/docs/Web/Security/Subresource_Integrity",children:"Doc Subresource Integrity"}),"."]})},x=[{name:"impact",label:"Impact",render:function(e){return(0,n.jsx)(h,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){b(e,r,t[r])}))}return e}({},e))}},{name:"score_description",label:"Description"},{name:"documentation",label:"Documentation",render:function(e){var r=e.name;return g[r]||"-"}}],y=function(e){var r=e.data;if(!r.url)return null;var t=r&&"https://observatory.mozilla.org/analyze/".concat((0,d.p5)(r.url.replace(/^(https?:\/\/[^/]+).*/,"$1")))||null,i=Object.keys(r.details).filter((function(e){return!r.details[e].pass})).map((function(e){return r.details[e]}));return i.sort((function(e,r){return e.score_modifier-r.score_modifier})),t?(0,n.jsxs)(m.s,{title:"Mozilla HTTP observatory",url:t,urlText:"Rapport d\xe9taill\xe9",isExternal:!0,children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(p.G,{small:!0,grade:r.grade})]}),i.length&&(0,n.jsx)(a.Table,{rowKey:"name",columns:x,data:i})||null]}):(0,n.jsx)(n.Fragment,{})};function j(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function v(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function w(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){v(e,r,t[r])}))}return e}function _(e){return function(e){if(Array.isArray(e))return j(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"===typeof e)return j(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return j(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var O=(0,t(5152).default)((function(){return Promise.all([t.e(661),t.e(429)]).then(t.bind(t,22429))}),{loadableGenerated:{webpack:function(){return[22429]}},ssr:!1}),S=["#ff6666","#ffce00","#00b353"],T=function(e){var r=_(e.segmentColors||S);return e.reverseColors&&r.reverse(),(0,n.jsx)("div",{style:{background:"#FFF"},children:(0,n.jsx)(O,w({forceRender:!0},e,{segmentColors:r}))})},k=t(63613),A=t(81493),P=t.n(A),N=t(91521),I=t.n(N),C=function(e){var r=e.children,t=e.title,i=e.value;return(0,n.jsxs)("div",{className:I().card,children:[r,t&&(0,n.jsx)("div",{className:I().cardTitle,children:t}),i&&(0,n.jsx)("div",{className:I().cardValue,children:i})]})},D=function(e){var r=0,t=0,n=e;return n>6e4&&(n-=6e4*(r=Math.floor(n/6e4))),n>1e3&&(n-=1e3*(t=Math.floor(n/1e3))),r>0?"".concat(r,"min ").concat((t/100).toFixed(),"s"):"".concat(t,".").concat((n/100).toFixed(),"s")},E=function(e){var r=1e3,t=0,n=0,i=e;return i>1e6&&(i-=(t=Math.floor(i/1e6))*r*r),i>r&&(i-=(n=Math.floor(i/r))*r),t>0?"".concat(t,".").concat((n/100).toFixed(),"Mb"):"".concat(n,".").concat((i/100).toFixed(),"Kb")},F=function(e){var r=e.data,t=e.url;if(!r.audits.metrics.details)return null;var i={"First contentful Paint":r.audits.metrics.details&&r.audits.metrics.details.items&&D(r.audits.metrics.details.items[0].firstContentfulPaint),"Time to interactive":r.audits.metrics.details&&r.audits.metrics.details.items&&D(r.audits.metrics.details.items[0].interactive),"Total requests":r.audits.diagnostics.details&&r.audits.diagnostics.details.items&&r.audits.diagnostics.details.items[0].numRequests,"Total weight":r.audits.diagnostics.details&&r.audits.diagnostics.details.items&&E(r.audits.diagnostics.details.items[0].totalByteWeight)};return r.categories.performance.score=function(e){var r,t,n,i,a=(null===(r=e.audits.diagnostics.details)||void 0===r?void 0:r.items)&&(null===(t=e.audits.diagnostics.details)||void 0===t?void 0:t.items[0].numRequests),l=(null===(n=e.audits.diagnostics.details)||void 0===n?void 0:n.items)&&(null===(i=e.audits.diagnostics.details)||void 0===i?void 0:i.items[0].totalByteWeight),o=1048576,s=100;return a>50&&(s-=Math.min(50,5*(a-50))),l>o&&(s-=Math.min(50,(l-o)/1048576*20)),Math.max(0,s/100)}(r),(0,n.jsxs)(m.s,{title:"LightHouse",info:"Informations collect\xe9es par l'outil Google LightHouse",url:t,urlText:"Rapport LightHouse",isExternal:!0,children:[(0,n.jsx)(a.Row,{children:(0,n.jsx)(a.Col,{children:(0,n.jsx)(k.D,{className:P().accesibility})})}),(0,n.jsx)(a.Row,{children:["accessibility","performance","seo","best-practices"].map((function(e){var t=r.categories[e],i=t.score;return!Number.isNaN(i)&&(0,n.jsx)(a.Col,{n:"12 sm-12 md-6 lg-3",className:"fr-mb-2w",children:(0,n.jsx)(C,{title:t.title,value:"".concat((100*i).toFixed(),"%"),children:(0,n.jsx)(T,{width:180,height:120,value:100*i,minValue:0,maxValue:100,segments:3,currentValueText:""})})},t.id)}))}),(0,n.jsx)(a.Row,{children:Object.keys(i).map((function(e){return(0,n.jsx)(a.Col,{n:"12 sm-12 md-6 lg-3",className:"fr-mb-2w",children:(0,n.jsx)(C,{title:e,value:i[e]})},e)}))})]})};function L(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var M=function(e){var r=e.info&&e.info.severity||"critical",t="critical"===r||"high"===r?"danger":"medium"===r?"warning":"low"===r?"info":"success";return(0,n.jsx)(f.Z,{className:"w-100",variant:t,children:r})},R="info,low,medium,high,critical".split(","),V=function(e,r){return R.indexOf(e.info.severity)-R.indexOf(r.info.severity)},H=[{name:"severity",label:"S\xe9verit\xe9",render:function(e){return(0,n.jsx)(M,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){L(e,r,t[r])}))}return e}({},e))}},{name:"templateID",label:"id"},{name:"name",label:"Name",render:function(e){return e.info.name}},{name:"matcher_name",label:"Matcher"}],Z=function(e){var r=e.data;return r.sort(V),r.length&&(0,n.jsx)(m.s,{title:"Nuclei",info:"D\xe9tection d'erreurs de configuration et vuln\xe9rabilit\xe9s",children:(0,n.jsx)(a.Table,{rowKey:function(e){return e.templateID+e.matcher_name},columns:H,data:r})})||null};function z(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var G=function(e,r){var t=parseInt(r.riskcode)-parseInt(e.riskcode);return 0===t?parseInt(r.confidence)-parseInt(e.confidence):t},U=function(e){var r=e.riskcode,t="0"===r||"1"===r?"info":"2"===r?"warning":"3"===r?"danger":"info";return(0,n.jsx)(f.Z,{className:"w-100",variant:t,children:e.riskdesc})},W=[{name:"risk",label:"Risk/Confidence",render:function(e){return(0,n.jsx)(U,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){z(e,r,t[r])}))}return e}({},e))}},{name:"name",label:"Name"}],K=function(e){var r=e.data,t=e.url,i=r&&r.site&&r.site.flatMap((function(e){return e.alerts}))||[];return i.sort(G),i.length&&(0,n.jsx)(m.s,{isExternal:!0,title:"Scan OWASP",url:t,urlText:"Rapport d\xe9taill\xe9",info:"Scan passif de vuln\xe9rabili\xe9s ZAP OWASP baseline",children:(0,n.jsx)(a.Table,{columns:W,data:i,rowKey:"name"})})||null},q=t(11510);function B(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var X=["INFO","OK","LOW","MEDIUM","HIGH","CRITICAL"],$=function(e){return function(r,t,n){return!n.find((function(n,i){return i<t&&n[e]===r[e]}))}},Q=function(e){var r,t=e.data,i=e.url,l=t.find((function(e){return"overall_grade"===e.id})),o=t&&l&&l.finding;t.map((function(e){return function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){B(e,r,t[r])}))}return e}({},e,{severity_value:(r=e.severity,X.indexOf(r))});var r})).sort((r="severity_value",function(e,t){return e[r]>t[r]?1:e[r]<t[r]?-1:0})).reverse();var s=t.filter((function(e){return 0===e.id.indexOf("grade_cap_reason_")})).reverse(),c=t.find((function(e){return"cert_notAfter"===e.id})),u=t.find((function(e){return"intermediate_cert_notAfter <#1>"===e.id})),d=null;c&&(d=u?Math.min(new Date(c.finding).getTime(),new Date(u.finding).getTime()):new Date(c.finding).getTime());var f=d&&(new Date).getTime()+2592e6>d;return o&&(0,n.jsx)(m.s,{title:"SSL",info:"Informations sur la qualit\xe9 des certificats SSL via testssl.sh",url:i,urlText:"Rapport d\xe9taill\xe9",isExternal:!0,children:(0,n.jsx)(a.Row,{children:(0,n.jsxs)(a.Col,{children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(p.G,{small:!0,grade:o})]}),s.length>0&&(0,n.jsx)("br",{}),s.filter($("finding")).map((function(e){return(0,n.jsx)(a.Alert,{type:"info",title:e.finding},e.finding)})),d&&(0,n.jsxs)("h4",{children:[(0,n.jsx)("br",{}),"Expiration : ",(0,q.Z)(d,"dd/MM/yyyy"),f&&" \u26a0\ufe0f"]})]})})})||null},J=t(25813);function Y(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ee(e){return function(e){if(Array.isArray(e))return Y(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"===typeof e)return Y(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Y(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var re=[{name:"name",label:"Cookies"},{name:"domain",label:"Domaine"},{name:"httpOnly",label:"HTTP Only",render:function(e){return e.httpOnly?"\u2714\ufe0f":"\u274c"}},{name:"secure",label:"Secure",render:function(e){return e.secure?"\u2714\ufe0f":"\u274c"}}],te=function(e){var r=e.cookies;return r&&r.length&&(0,n.jsx)(a.Table,{rowKey:"name",columns:re,data:r})||null},ne=[{name:"type",label:"Type"},{name:"url",label:"URL",render:function(e){return function(e){return(0,n.jsx)("a",{href:e,children:"".concat((0,d.p5)(e).substring(0,25),"...")})}(e.url)}},{name:"details",label:"Rem\xe9diation",render:function(e){var r=e.details;return r&&r.message}}],ie=function(e){var r,t=e.trackers;return t&&t.length&&(0,n.jsx)(a.Table,{columns:ne,data:t.filter((r=function(e,r){return"unknown"!==e.type&&e.type||r},function(e,t,n){return!n.find((function(n,i){return i<t&&r(n,t)===r(e,t+1)}))})),rowKey:function(e){return e.type+e.url}})||null},ae=[{name:"flag",label:"Flag",render:function(e){if(e.geoip&&e.geoip.country){var r=J.ZP[e.geoip.country.iso_code];return(0,n.jsx)(r,{style:{width:60},title:e.geoip.country.names.fr})}return null}},{name:"hostname",label:"Hostname"},{name:"ip",label:"IP"},{name:"city",label:"City",render:function(e){return e.geoip&&e.geoip.city&&e.geoip.city.names.fr||"?"}},{name:"country",label:"Country",render:function(e){return e.geoip&&e.geoip.country&&e.geoip.country.names.fr||"?"}}],le=function(e){var r,t=e.endpoints;return t&&t.length&&(0,n.jsx)(a.Table,{columns:ae,data:t.sort((r=function(e){var r,t,n;return(null===(r=e.geoip)||void 0===r||null===(t=r.country)||void 0===t||null===(n=t.names)||void 0===n?void 0:n.fr)||""},function(e,t){return r(e).localeCompare(r(t))})),rowKey:"ip"})||null},oe=function(e){var r,t,i=e.data,l=[];i.cookies&&i.cookies.length&&(r=l).push.apply(r,ee(i.cookies));i.trackers&&i.trackers.length&&(t=l).push.apply(t,ee(i.trackers));return l.length&&(0,n.jsxs)(m.s,{title:"Scripts tiers et cookies",info:"Scripts tiers embarqu\xe9s dans la page web",children:[(0,n.jsx)(te,{cookies:i.cookies}),(0,n.jsx)(ie,{trackers:i.trackers}),(0,n.jsx)(le,{endpoints:i.endpoints})]})||(0,n.jsx)(m.s,{title:"Third parties",info:"Scripts tiers embarqu\xe9s dans la page web",children:(0,n.jsx)(a.Alert,{type:"success",title:"",description:"Aucun script third-party detect\xe9"})})},se=[{name:"name",label:"Name"},{name:"categories",label:"Categories",render:function(e){var r=e.categories;return r&&r.map((function(e){return e.name})).join(", ")}},{name:"website",label:"Website",render:function(e){var r=e.website;return(0,n.jsx)("a",{href:r,target:"_blank",rel:"nopoener noreferrer",children:r})}}],ce=function(e){var r=e.data;return r&&r.technologies&&r.technologies.length&&(0,n.jsx)(m.s,{title:"Wappalyzer",info:"D\xe9tection des technologies utilis\xe9es",children:(0,n.jsx)(a.Table,{rowKey:"name",columns:se,data:r.technologies})})||null},ue=t(75830),de=t(83587),fe=t.n(de),me=function(e){var r,t=e.data,i=e.url,l=t&&"https://updown.io/".concat(t.token)||null;return l&&(0,d.p5)(t.url)===(0,d.p5)(i)&&(0,n.jsxs)(m.s,{title:"Disponibilit\xe9 et temps de r\xe9ponse",info:"Informations collect\xe9es par updown.io",url:l,urlText:"Statistiques d\xe9taill\xe9es",isExternal:!0,children:[(0,n.jsxs)(a.Row,{children:[(0,n.jsx)(a.Col,{n:"12 sm-12 md-4",className:"fr-mb-3w",children:(0,n.jsx)(C,{title:"Taux de disponibilit\xe9 sur un mois glissant",value:"".concat(t.uptime,"%"),children:(0,n.jsx)(T,{width:200,height:120,value:t.uptime,minValue:0,maxValue:100,segments:3,currentValueText:""})})}),void 0!==(null===t||void 0===t||null===(r=t.metrics)||void 0===r?void 0:r.apdex)&&(0,n.jsx)(a.Col,{n:"12 sm-12 md-4",className:"fr-mb-3w",children:(0,n.jsx)(C,{title:"APDEX: Application Performance Index",value:"".concat(t.metrics.apdex),children:(0,n.jsx)(T,{width:200,height:120,value:t.metrics.apdex,minValue:0,maxValue:1,segments:3,currentValueText:""})})}),t.metrics&&t.metrics.timings&&(0,n.jsx)(a.Col,{n:"12 sm-12 md-4",className:"fr-mb-3w",children:(0,n.jsx)(C,{title:"Temps de r\xe9ponse",value:"".concat(t.metrics.timings.total,"ms"),children:(0,n.jsx)(T,{width:200,height:120,value:Math.max(0,t.metrics.timings.total),minValue:0,maxValue:1e3,customSegmentStops:[0,150,500,1e3],reverseColors:!0,currentValueText:""})})})]}),(0,n.jsx)(a.Row,{className:fe().left,children:(0,n.jsx)(a.Col,{n:"12",className:"fr-mb-3w",children:t.ssl&&(0,n.jsxs)("div",{style:{padding:10},children:[(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Le certificat SSL est"," ",t.ssl.valid?(0,n.jsx)(p.G,{small:!0,grade:"A+",label:"valide"}):(0,n.jsx)(p.G,{small:!0,grade:"F",label:"invalide"})," ","et expire le"," ",(0,n.jsx)("strong",{children:(0,q.Z)(new Date(t.ssl.expires_at),"dd/MM/yyyy",{locale:ue.Z})})]})})})]})||(0,n.jsx)(m.s,{title:"Temps de r\xe9ponse",info:"Informations collect\xe9es par updown.io",children:(0,n.jsx)(a.Alert,{variant:"success",children:"Aucune donn\xe9e updown.io associ\xe9e"})})};function pe(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var be=function(e,r){var t=new Map;return t.set("CRITICAL",3),t.set("HIGH",2),t.set("MODERATE",1),t.set("LOW",0),t.get(r.securityVulnerability.severity)-t.get(e.securityVulnerability.severity)},he=function(e){var r=e.securityVulnerability.severity,t="LOW"===r?"info":"MODERATE"===r?"warning":"HIGH"===r||"CRITICAL"===r?"danger":"info";return(0,n.jsx)(f.Z,{className:"w-100",variant:t,children:r})},ge=[{name:"severity",label:"S\xe9v\xe9rit\xe9",render:function(e){return(0,n.jsx)(he,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){pe(e,r,t[r])}))}return e}({},e))}},{name:"dependancy",label:"d\xe9pendance vuln\xe9rable",render:function(e){return e.securityVulnerability.package.name}},{name:"vulnerabilities",label:"Vuln\xe9rabilit\xe9s",render:function(e){return e.securityVulnerability.advisory.references.map((function(e,r){return(0,n.jsxs)("p",{children:[(0,n.jsx)("a",{target:"_blank",href:e.url,rel:"noopener noreferrer",children:(0,d.Q_)(e.url)}),(0,n.jsx)("br",{})]},(0,d.Q_)(e.url)+r)}))}}],xe=function(e){var r=e.data,t=(e.url,r&&r.vulnerabilityAlerts.totalCount>0?r.vulnerabilityAlerts.nodes:[]);return r.vulnerabilityAlerts.nodes.sort(be),r.vulnerabilityAlerts.totalCount>0&&(0,n.jsxs)(m.s,{title:"Alertes Dependabot",url:"".concat(r.url,"/security/dependabot"),urlText:"Alertes dependabot",isExternal:!0,info:(0,n.jsxs)("span",{children:["Vuln\xe9rabilit\xe9s des d\xe9pendances du d\xe9p\xf4t Github"," ",r.url.replace(/^https:\/\/github\.com\/(.*)/,"$1")]}),children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(p.G,{small:!0,grade:r.grade})]}),(0,n.jsx)(a.Table,{columns:ge,data:t,rowKey:"createdAt"})]})||null};function ye(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var je=function(e,r){var t=new Map;return t.set("error",1),t.set("warning",0),t.get(r.rule.severity)-t.get(e.rule.severity)},ve=function(e){var r=e.rule.severity,t="warning"===r?"warning":"error"===r?"danger":"info";return(0,n.jsx)(f.Z,{className:"w-100",variant:t,children:r})},we=[{name:"severity",label:"S\xe9v\xe9rit\xe9",render:function(e){return(0,n.jsx)(ve,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){ye(e,r,t[r])}))}return e}({},e))}},{name:"rule",label:"R\xe8gle",render:function(e){return e.rule.name}},{name:"description",label:"Description",render:function(e){return(0,n.jsx)("a",{target:"_blank",href:e.html_url,rel:"noopener noreferrer",children:e.rule.description})}}],_e=function(e){var r=e.data,t=(e.url,r&&r.alerts.length>0?r.alerts:[]);return t.sort(je),t.length>0&&(0,n.jsxs)(m.s,{title:"CodeScan",url:"".concat(r.url,"/security/code-scanning"),urlText:"Alertes CodeQL",isExternal:!0,info:(0,n.jsxs)("span",{children:["Scan statique du code du d\xe9p\xf4t Github"," ",r.url.replace(/^https?:\/\/[^/]+\/(.*)/,"$1")]}),children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(p.G,{small:!0,grade:r.grade})]}),(0,n.jsx)(a.Table,{columns:we,data:t,rowKey:"rule"})]})||null};function Oe(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Se=function(e,r){return e+Number.parseFloat(r.cvss)},Te=function(e,r){return r.service.vulnerabilities.reduce(Se,0)-e.service.vulnerabilities.reduce(Se,0)},ke=function(e){return e.vulnerabilities.filter((function(e){return e.is_exploit})).length>0},Ae=function(e){var r=e.vulnerabilities.reduce(Se,0),t=!ke(e)&&r>5*e.vulnerabilities.length?"warning":ke(e)&&r>5*e.vulnerabilities.length?"danger":"info";return(0,n.jsx)(f.Z,{className:"w-100",variant:t,children:t})},Pe=[{name:"severty",label:"S\xe9v\xe9rit\xe9",render:function(e){return(0,n.jsx)(Ae,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){Oe(e,r,t[r])}))}return e}({},e))}},{name:"service",label:"Service \xe0 l'\xe9coute",render:function(e){return"".concat(e.name," (port:").concat(e.id,")")}},{name:"vulnerability",label:"Vuln\xe9rabilit\xe9s",render:function(e){return e.vulnerabilities.map((function(e){return(0,n.jsxs)("div",{children:[(0,n.jsx)("a",{target:"_blank",href:"https://vulners.com/cve/".concat(e.id),rel:"noopener noreferrer",children:e.id}),(0,n.jsx)("br",{})]},e.id)}))}}],Ne=function(e){var r=e.data,t=e.url,i=r&&r.open_ports.length>0?r.open_ports:[];return r.open_ports.sort(Te),r.open_ports.length>0&&(0,n.jsxs)(m.s,{title:"Nmap",url:t,urlText:"Rapport d\xe9taill\xe9",isExternal:!0,info:(0,n.jsxs)("span",{children:["Scan des vuln\xe9rabili\xe9s nmap"," ",(0,n.jsx)("a",{style:{color:"white"},href:"https://".concat(r.host),target:"_blank",rel:"noopener noreferrer",children:"https://".concat(r.host)})]}),children:[(0,n.jsxs)("h3",{children:["Scan Summary : ",(0,n.jsx)(p.G,{small:!0,grade:r.grade})]}),(0,n.jsx)(a.Table,{columns:Pe,data:i.map((function(e){return e.service})),rowKey:"id"})]})||null},Ie=function(e){var r=e.data,t=e.url;return r&&(0,n.jsx)(m.s,{title:"Page /stats",info:"Cette page permet de publier vos mesures d'impact",children:"A"===r.grade&&(0,n.jsx)(a.Alert,{type:"success",description:(0,n.jsxs)(n.Fragment,{children:["Page bien d\xe9t\xe9ct\xe9e :"," ",(0,n.jsxs)("a",{href:"".concat(t,"/").concat(r.uri),children:[t,"/",r.uri]})]})})||(0,n.jsx)(a.Alert,{type:"error",title:"",description:"La page /stats n'a pas \xe9t\xe9 d\xe9tect\xe9e !"})})||null},Ce=[{name:"link",label:"URL"}],De=function(e){var r=e.data;return r&&r.length&&(0,n.jsx)(m.s,{title:"Erreurs 404",info:"Pages introuvables",children:(0,n.jsx)(a.Table,{rowKey:"link",columns:Ce,data:r})})||null};function Ee(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Fe="UNKNOWN,LOW,MEDIUM,HIGH,CRITICAL".split(","),Le=function(e,r){return Fe.indexOf(r.Severity)-Fe.indexOf(e.Severity)},Me=function(e){var r=e.Severity,t="LOW"===r||"MEDIUM"===r?"info":"HIGH"===r?"warning":"CRITICAL"===r?"danger":"info";return(0,n.jsx)(f.Z,{className:"w-100",variant:t,children:e.Severity})},Re=[{name:"Severity",label:"S\xe9v\xe9rit\xe9",render:function(e){return(0,n.jsx)(Me,function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){Ee(e,r,t[r])}))}return e}({},e))}},{name:"VulnerabilityID",label:"Vulnerability ID",render:function(e){return(0,n.jsx)("a",{target:"_blank",rel:"noreferrer noopener",href:e.PrimaryURL,children:e.VulnerabilityID})}},{name:"Title",label:"Titre"}],Ve=function(e){var r=e.data;return(0,n.jsx)(l.Fragment,{children:r.length&&r.filter((function(e){return e.ArtifactName})).map((function(e){var r,t;return e&&((0,n.jsxs)(m.s,{isExternal:!0,title:"Image docker ".concat(e.ArtifactName),info:"Scan de vuln\xe9rabilit\xe9s Trivy",children:[(0,n.jsx)("h6",{children:e.Target}),e.Vulnerabilities&&e.Vulnerabilities.length?(0,n.jsx)(a.Table,{columns:Re,data:null===(r=e.Vulnerabilities)||void 0===r?void 0:r.sort(Le).filter((t="VulnerabilityID",function(e,r,n){return!n.find((function(n,i){return i<r&&n[t]===e[t]}))})),rowKey:"VulnerabilityID"}):(0,n.jsx)(a.Alert,{type:"success",title:"",description:"Aucune vuln\xe9rabilit\xe9 d\xe9tect\xe9e par Trivy"})]},e.ArtifactName)||null)}))||null})},He=function(e){var r=e.data,t={mention:{"Accessibilit\xe9 : totalement conforme":(0,n.jsx)(a.Alert,{type:"success",description:(0,n.jsx)(n.Fragment,{children:"La mention a bien \xe9t\xe9 detect\xe9e : Totalement conforme"})}),"Accessibilit\xe9 : partiellement conforme":(0,n.jsx)(a.Alert,{type:"success",description:(0,n.jsx)(n.Fragment,{children:"La mention a bien \xe9t\xe9 detect\xe9e : Partiellement conforme"})}),"Accessibilit\xe9 : non conforme":(0,n.jsx)(a.Alert,{type:"info",description:(0,n.jsx)(n.Fragment,{children:"La mention a bien \xe9t\xe9 detect\xe9e : Non conforme"})}),null:(0,n.jsx)(a.Alert,{type:"error",title:"",description:(0,n.jsx)(n.Fragment,{children:"La mention de conformit\xe9 n'a pas \xe9t\xe9 d\xe9tect\xe9e. La mention \xab Accessibilit\xe9 : non conforme \xbb doit \xeatre pr\xe9sente sur chaque page."})})},declaration:{true:(0,n.jsx)(a.Alert,{type:"success",title:"",description:(0,n.jsxs)(n.Fragment,{children:["La d\xe9claration est disponible sur :"," ",(0,n.jsx)("a",{href:r.declarationUrl,target:"_blank",rel:"noopener noreferrer",children:r.declarationUrl})]})}),false:(0,n.jsx)(a.Alert,{type:"error",title:"",description:(0,n.jsxs)(n.Fragment,{children:["La d\xe9claration n'a pas \xe9t\xe9 trouv\xe9e. Utilisez le"," ",(0,n.jsx)("a",{href:"https://betagouv.github.io/a11y-generateur-declaration",target:"_blank",rel:"noopener noreferrer",children:"g\xe9n\xe9rateur de d\xe9claration"})," ","pour en cr\xe9er une."]})})}};return r&&(0,n.jsxs)(m.s,{title:"D\xe9claration de mise en accessibilit\xe9",info:"Une mention de conformit\xe9 pointant sur une d\xe9claration d'accessibilit\xe9 est obligatoire sur les sites et applications de l'\xe9tat",children:[t.mention[r.mention||"null"],t.declaration[""+!!r.declarationUrl]]})||null},Ze=t(41664),ze=function(e){var r=e.id,t=e.selected,i=e.index,a=e.icon,l=e.label,o=e.href;return(0,n.jsx)("li",{role:"presentation",children:(0,n.jsx)(Ze.default,{href:o,children:(0,n.jsxs)("button",{type:"button",role:"tab",id:"fr-tab-".concat(i),"aria-selected":t,tabIndex:0,"aria-controls":"fr-tabpanel-".concat(i),className:"fr-tabs__tab",children:[a,l]})})},r)},Ge=function(e){var r=e.id,t=e.tabIndex,i=e.selected,l=e.items;return(0,n.jsx)("div",{id:"fr-tabpanel-".concat(t),className:"fr-tabs__panel ".concat(i?"fr-tabs__panel--selected":""),style:{paddingTop:30},role:"tabpanel","aria-labelledby":"fr-tab-".concat(t),tabIndex:0,children:i&&l&&l.length?l:(0,n.jsx)(a.Alert,{type:"warning",description:(0,n.jsx)(n.Fragment,{children:"Aucune information trouv\xe9e dans cette cat\xe9gorie"})})},r)},Ue=t(90791),We=t(4314),Ke=t(73313),qe=t.n(Ke),Be=function(e){var r=e.report,t=e.url,i=r&&r.lhr&&r.lhr.fetchTime;return(0,n.jsxs)(a.Callout,{hasInfoIcon:!1,className:"fr-mb-3w",children:[(0,n.jsx)(a.CalloutTitle,{as:"h4",children:(0,n.jsx)("a",{href:t,rel:"noreferrer noopener",target:"_blank",children:t})}),(0,n.jsxs)(a.CalloutText,{children:[r.category&&(0,n.jsx)(f.Z,{className:qe().badge,variant:"success",to:"/category/".concat(r.category),children:r.category}),r.tags&&r.tags.map((function(e){return(0,n.jsx)(f.Z,{className:qe().badge,variant:"info",to:"/tag/".concat(e),children:e},e)})),i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Ue.Z,{size:16,className:qe().clockIcon}),(0,n.jsxs)("span",{title:i,className:qe().clock,children:["Mise \xe0 jour il y a :"," ",(0,We.Z)(new Date(i),{locale:ue.Z})]})]})]}),r.screenshot&&(0,n.jsx)("div",{className:qe().image,children:(0,n.jsx)("img",{alt:"Copie d'\xe9cran de ".concat(t),src:"".concat("","/report/").concat((0,d.r3)(t),"/screenshot.jpeg")})})]})};function Xe(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function $e(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){Xe(e,r,t[r])}))}return e}var Qe=function(e){var r=e.id;return(0,n.jsx)("div",{id:r})},Je=[{label:"Bonnes pratiques",id:"best-practices",icon:(0,n.jsx)(o.Z,{size:16,style:{marginRight:5,marginBottom:-2}}),items:[{id:"lighthouse",reportKey:"lhr",render:function(e,r){return(0,n.jsx)(F,{data:e.lhr,url:"".concat("","/report/").concat((0,d.r3)(r),"/lhr.html")})}},{id:"thirdparties",render:function(e,r){return(0,n.jsx)(oe,{data:e.thirdparties})}},{id:"stats",render:function(e,r){return(0,n.jsx)(Ie,{data:e.stats,url:r})}},{id:"declaration-a11y",render:function(e,r){return(0,n.jsx)(He,{data:e["declaration-a11y"]})}},{id:"404",render:function(e,r){return e[404].length&&(0,n.jsx)(De,{data:e[404]})}}]},{label:"Disponibilit\xe9",id:"disponibilite",icon:(0,n.jsx)(s.Z,{size:16,style:{marginRight:5,marginBottom:-2}}),items:[{id:"updownio",render:function(e,r){return(0,n.jsx)(me,{data:e.updownio,url:r})}}]},{label:"S\xe9curit\xe9",id:"securite",icon:(0,n.jsx)(c.Z,{size:16,style:{marginRight:5,marginBottom:-2}}),items:[{id:"nmap",render:function(e,r){return(0,n.jsx)(Ne,{data:e.nmap,url:"".concat("","/report/").concat((0,d.r3)(r),"/nmapvuln.html")})}},{id:"http",render:function(e,r){return(0,n.jsx)(y,{data:e.http})}},{id:"testssl",render:function(e,r){return(0,n.jsx)(Q,{data:e.testssl,url:"".concat("","/report/").concat((0,d.r3)(r),"/testssl.html")})}},{id:"dependabot",render:function(e,r){return e.dependabot.repositories&&e.dependabot.repositories.filter(Boolean).map((function(e){return(0,n.jsx)(xe,{data:e,url:r},e.url)}))}},{id:"codescan",render:function(e,r){return e.codescan.repositories&&e.codescan.repositories.filter(Boolean).map((function(e){return(0,n.jsx)(_e,{data:e,url:r},e.url)}))}},{id:"zap",render:function(e,r){return(0,n.jsx)(K,{data:e.zap,url:"".concat("","/report/").concat((0,d.r3)(r),"/zap.html")})}},{id:"nuclei",render:function(e,r){return(0,n.jsx)(Z,{data:e.nuclei})}},{id:"trivy",render:function(e,r){return e.trivy.length&&(0,n.jsx)(Ve,{data:e.trivy})}}]},{label:"Informations",id:"informations",icon:(0,n.jsx)(u.Z,{size:16,style:{marginRight:5,marginBottom:-2}}),items:[{id:"wappalyzer",render:function(e,r){return(0,n.jsx)(ce,{data:e.wappalyzer})}}]}],Ye=function(e){var r=e.url,t=e.report,i=e.selectedTab;if(l.useEffect((function(){var e=document.location.hash.split("#");if(3===e.length){var r=document.getElementById(e[2]);r&&r.scrollIntoView()}}),[t]),!t)return(0,n.jsxs)("div",{children:["No data available for",r]});var a=Math.max(0,Je.findIndex((function(e){return i===e.id}))),o=Je[a];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Be,{report:t,url:r}),(0,n.jsxs)("div",{className:"fr-tabs",children:[(0,n.jsx)("ul",{className:"fr-tabs__list",role:"tablist",children:Je.map((function(e,t){return(0,n.jsx)(ze,$e({selected:o.id===e.id,index:t,href:"/url/".concat((0,d.N0)(r),"/").concat(e.id)},e),e.id)}))}),Je.map((function(e,i){var a=e.items.filter((function(e){return!!t[e.reportKey||e.id]&&(0,d.y$)(e.id)})).map((function(e){return(0,n.jsxs)("div",{children:[(0,n.jsx)(Qe,{id:e.id}),e.render(t,r)]},e.id)}));return(0,l.createElement)(Ge,$e({},e,{key:e.id,tabIndex:i,selected:o.id===e.id,items:a}))}))]})]})},er=!0,rr=function(e){var r=e.report,t=e.url,l=e.selectedTab;return r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.default,{children:(0,n.jsxs)("title",{children:["DashLord - ",t]})}),(0,n.jsx)(Ye,{url:t,report:r,selectedTab:l})]}):(0,n.jsx)(a.Alert,{type:"error",title:"Impossible de trouver le rapport"})}},84517:function(e,r,t){"use strict";var n=t(85893),i=t(94184),a=t.n(i),l=(t(67294),t(11163)),o=t(32905),s=t.n(o);r.Z=function(e){var r=e.children,t=e.variant,i=e.className,o=e.to,c=(0,l.useRouter)();return(0,n.jsx)("button",{type:"button",className:a()(i,s()[t]),onClick:function(){o&&c.push(o)},children:r})}},20836:function(e,r,t){"use strict";t.d(r,{G:function(){return s}});var n=t(85893),i=(t(67294),t(84517)),a=t(42779),l=t.n(a),o={A:"success",B:"info",C:"info",D:"warning",E:"warning",F:"danger"},s=function(e){var r=e.grade,t=e.warning,a=e.label,s=e.to,c=e.small,u="".concat(r).substring(0,1).toUpperCase(),d=o[u]||"danger",f=void 0!==a?a:r;return(0,n.jsxs)(i.Z,{variant:d,className:l()[c?"small":"big"],to:s,children:[f,t&&(0,n.jsx)("span",{title:t,style:{marginLeft:5},children:"\u26a0\ufe0f"})]})}},18121:function(e,r,t){"use strict";t.d(r,{s:function(){return f}});var n=t(85893),i=(t(67294),t(94184)),a=t.n(i),l=t(79223),o=t(73973),s=t(83206),c=t(41664),u=t(75670),d=t.n(u),f=function(e){var r=e.title,t=e.children,i=e.info,u=e.url,f=e.urlText,m=void 0===f?"":f,p=e.className,b=e.isExternal,h=void 0!==b&&b;return(0,n.jsxs)("div",{className:a()(d().container,p),children:[(0,n.jsxs)("div",{className:d().banner,children:[(0,n.jsx)("h5",{className:d().mainTitle,children:r}),i&&(0,n.jsx)(l.Z,{overlay:i,children:(0,n.jsx)(o.Z,{size:20,style:{marginLeft:5,cursor:"pointer"}})}),u&&(h?(0,n.jsx)("a",{style:{float:"right"},href:u,target:"_blank",rel:"noreferrer noopener",children:m}):(0,n.jsx)(c.default,{prefetch:!1,href:u,children:(0,n.jsxs)("a",{style:{float:"right"},children:[m,(0,n.jsx)(s.Z,{})]})}))]}),(0,n.jsx)("div",{className:d().body,children:t})]})}},63613:function(e,r,t){"use strict";t.d(r,{D:function(){return i}});var n=t(85893),i=(t(67294),function(e){var r=e.className;return(0,n.jsxs)("div",{className:r,children:["Moins de 25% des crit\xe8res d'accessibilit\xe9 peuvent \xeatre test\xe9s automatiquement, ",(0,n.jsx)("strong",{children:"une expertise manuelle est requise"}),".",(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),"Ce score ne repr\xe9sente pas le score RGAA mais une partie des bonnes pratiques de base \xe0 appliquer."]})})},32905:function(e){e.exports={success:"badge_success__HjgKW",info:"badge_info__eK6GA",warning:"badge_warning__5QJuG",danger:"badge_danger__Lexxg"}},91521:function(e){e.exports={card:"card_card__afbUo",cardValue:"card_cardValue__zfpCd",cardTitle:"card_cardTitle__LRcj8"}},42779:function(e){e.exports={small:"grade_small__EU1s6",big:"grade_big__iN2Jf"}},81493:function(e){e.exports={accesibility:"lightHouse_accesibility__k5UoB"}},75670:function(e){e.exports={container:"panel_container__s3lQL",banner:"panel_banner__IDWUZ",mainTitle:"panel_mainTitle__N5MWp",body:"panel_body___c3aS"}},83587:function(e){e.exports={center:"updownIo_center__VX4HF",left:"updownIo_left__Uik_F",expiration:"updownIo_expiration__dGB_i"}},73313:function(e){e.exports={badge:"url_badge__giqcN",clockIcon:"url_clockIcon__mEI2N",clock:"url_clock__Jh8L8",image:"url_image__8lAEe"}}},function(e){e.O(0,[774,6,241,510,121,888,179],(function(){return r=50022,e(e.s=r);var r}));var r=e.O();_N_E=r}]);